package {	import fl.controls.TextInput;	import flash.events.*;	import flash.display.*;	import flash.text.TextField;	import fl.controls.Button;	public class GlobalSettings extends MovieClip{				var backgroundMC:MovieClip = new MovieClip;				function make(_stage,jsonData) { 					while (this.backgroundMC.numChildren > 0) {				this.backgroundMC.removeChildAt(this.backgroundMC.numChildren-1);			} 							backgroundMC.graphics.lineStyle(1,0xccccccc);			backgroundMC.graphics.drawRect(0, 10, 580, 32);			_stage.addChild(backgroundMC);						var bpmLabel:TextField = new TextField();			bpmLabel.text = "BPM";			bpmLabel.x = 5;			bpmLabel.y =18;			bpmLabel.height = 20;						var bpm:TextInput = new TextInput (); 			bpm.text = jsonData['project_info']['bpm'];			bpm.x = 50;			bpm.y =15;			bpm.height = 20;			bpm.width = 30;						bpm.addEventListener(KeyboardEvent.KEY_UP, bpmChange);						backgroundMC.addChild(bpmLabel);			backgroundMC.addChild(bpm);						function bpmChange(event) { 				jsonData['project_info']['bpm'] = event.target.text; 			}																		var bplLabel:TextField = new TextField();			bplLabel.text = "BPL";			bplLabel.x = 100;			bplLabel.y =18;			bplLabel.height = 20;			bpm.width = 30;						var bpl:TextInput = new TextInput (); 			bpl.text = jsonData['project_info']['bpl'];			bpl.x = 140;			bpl.y =15;			bpl.height = 20;			bpl.width = 40;						bpl.addEventListener(KeyboardEvent.KEY_UP, bplChange);						backgroundMC.addChild(bplLabel);			backgroundMC.addChild(bpl);									function bplChange(event) { 				jsonData['project_info']['bpl'] = event.target.text; 			}												var stepsLabel:TextField = new TextField();			stepsLabel.text = "Nunber of steps";			stepsLabel.x = 200;			stepsLabel.y =18;			stepsLabel.height = 20;						var steps:TextInput = new TextInput (); 			steps.text = jsonData['project_info']['steps'];			steps.x = 300;			steps.y =15;			steps.height = 20;			steps.width = 30;						backgroundMC.addChild(stepsLabel);			backgroundMC.addChild(steps);												var saveBtn:Button = new Button(); 			saveBtn.label = "Save";			saveBtn.x = 400;			saveBtn.y = 15;			saveBtn.width = 80;			saveBtn.addEventListener(MouseEvent.CLICK, save);			backgroundMC.addChild(saveBtn);							function save(eve) {									if (jsonData['banks'][0]['bank_options'][0]['sequence'].length > steps.text) { 					var bank_index= 0;					for each (var bank:Object in jsonData['banks']) {						var bank_option_index= 0;						for each (var bank_option:Object in bank['bank_options']) {							jsonData['banks'][bank_index]['bank_options'][bank_option_index]['sequence'].splice(steps.text);							bank_option_index++;						}						bank_index++;					}				}								if (jsonData['banks'][0]['bank_options'][0]['sequence'].length < steps.text) { 										bank_index= 0;					for each (bank in jsonData['banks']) {						bank_option_index= 0;						for each (bank_option in bank['bank_options']) {							longer_by = steps.text- jsonData['project_info']['steps'];							while (jsonData['banks'][bank_index]['bank_options'][bank_option_index]['sequence'].length < steps.text) { 								jsonData['banks'][bank_index]['bank_options'][bank_option_index]['sequence'].push("0");							}							bank_option_index++;						}						bank_index++;					}				}				jsonData['project_info']['steps'] = steps.text;				dispatchEvent(new Event("changed", true));			}		}	}}